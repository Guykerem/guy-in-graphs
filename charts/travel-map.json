{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 500,
  "title": "Countries Visited by Year",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/world-110m.json",
    "format": {
      "type": "topojson",
      "feature": "countries"
    }
  },
  "projection": {
    "type": "equirectangular",
    "center": [0, 30],
    "scale": 150
  },
  "transform": [
    {
      "calculate": "datum.id",
      "as": "country"
    },
    {
      "lookup": "country",
      "from": {
        "data": {
          "values": [
            {"id": "818", "name": "Egypt", "first_visit": 2000, "all_visits": "2000"},
            {"id": "840", "name": "United States", "first_visit": 1999, "all_visits": "1999, 2002, 2017"},
            {"id": "528", "name": "Netherlands", "first_visit": 2001, "all_visits": "2001, 2002, 2003, 2004, 2017"},
            {"id": "380", "name": "Italy", "first_visit": 2004, "all_visits": "2004, 2014, 2018, 2022"},
            {"id": "276", "name": "Germany", "first_visit": 2010, "all_visits": "2010, 2016, 2017, 2023"},
            {"id": "250", "name": "France", "first_visit": 2003, "all_visits": "2003, 2016"},
            {"id": "826", "name": "United Kingdom", "first_visit": 2002, "all_visits": "2002, 2017, 2024"},
            {"id": "208", "name": "Denmark", "first_visit": 2003, "all_visits": "2003"},
            {"id": "764", "name": "Thailand", "first_visit": 2004, "all_visits": "2004, 2022"},
            {"id": "188", "name": "Costa Rica", "first_visit": 2004, "all_visits": "2004, 2017"},
            {"id": "040", "name": "Austria", "first_visit": 2010, "all_visits": "2010"},
            {"id": "756", "name": "Switzerland", "first_visit": 2019, "all_visits": "2019, 2021, 2025"},
            {"id": "203", "name": "Czech Republic", "first_visit": 2017, "all_visits": "2017"},
            {"id": "170", "name": "Colombia", "first_visit": 2017, "all_visits": "2017"},
            {"id": "558", "name": "Nicaragua", "first_visit": 2017, "all_visits": "2017"},
            {"id": "320", "name": "Guatemala", "first_visit": 2017, "all_visits": "2017"},
            {"id": "124", "name": "Canada", "first_visit": 2017, "all_visits": "2017"},
            {"id": "784", "name": "United Arab Emirates", "first_visit": 2023, "all_visits": "2023"}
          ]
        },
        "key": "id",
        "fields": ["name", "first_visit", "all_visits"]
      }
    }
  ],
  "mark": {
    "type": "geoshape",
    "stroke": "#ccc",
    "strokeWidth": 0.5
  },
  "encoding": {
    "color": {
      "field": "first_visit",
      "type": "quantitative",
      "scale": {
        "domain": [1993, 2025],
        "range": ["#1f77b4", "#d62728"],
        "type": "linear"
      },
      "legend": {
        "title": "First Visit Year",
        "format": "d",
        "orient": "right",
        "gradientLength": 200
      }
    },
    "fillOpacity": {
      "condition": {
        "test": "datum.first_visit != null",
        "value": 1
      },
      "value": 1
    },
    "fill": {
      "condition": {
        "test": "datum.first_visit == null",
        "value": "#f0f0f0"
      }
    },
    "tooltip": [
      {"field": "name", "type": "nominal", "title": "Country"},
      {"field": "all_visits", "type": "nominal", "title": "Years Visited"}
    ]
  },
  "config": {
    "view": {"stroke": null},
    "legend": {
      "labelFont": "Helvetica Neue, sans-serif",
      "titleFont": "Helvetica Neue, sans-serif",
      "labelFontSize": 12,
      "titleFontSize": 14,
      "gradientThickness": 16
    }
  }
} 